{% extends "base_principal.html" %}
{% block title %}Inicio{% endblock title %}
{% load static from staticfiles %}   

{% block content %}  

    {% include "principal/navbar.html" %} 


    <form class="form-horizontal" method="post">{% csrf_token %}    
                <div class="panel panel-primary">
                    <!-- <div class="panel-heading">Alumnos</div>  -->
                    <div class="panel-body">
                        <div class="page-header">
                            <br>
                        <h3>
                            <a href="/" class="btn btn-success">
                            <span class="glyphicon glyphicon-chevron-left"></span> Regresar
                            </a>
                            <strong>Nueva Atencion</strong>
                        </h3>                                                        
                        </div><!-- page-header -->

                        <div class="row">    


                        <div class="col-xs-12 col-sm-6">                            
                            <div class="form-group">
                                <label for="alumno" class="hidden-xs col-sm-2">Alumno:</label>
                                <div class="input-group col-sm-10">
                                    {{form.alumno}}
                                    {{form.persona_display}} 
                                    {{form.persona_display.error}}
                                <span class="input-group-btn">
                                <button id="nuevoalumno"class="btn btn-info btn-add" type="button"  data-toggle="modal" data-target="#myModal"><span class="glyphicon   glyphicon-plus"></span></button>
                                </span>
                                </div>
                           </div>
                          
                           
                                
                                <div class="form-group">
                                    <label for="hospital" class="hidden-xs col-sm-2">Hospital:</label>
                                    <div class="col-sm-10">
                                        {{form.hospital}}
                                        {{form.hospital.errors}}
                                    </div>
                                </div>  

                                <div class="form-group">
                                    <label for="atencion" class="hidden-xs col-sm-2">Atencion:</label>
                                    <div class="col-sm-10">
                                        {{form.atencion}}
                                        {{form.atencion.errors}}
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="modalidad" class="hidden-xs col-sm-2">Modalidad:</label>
                                    <div class="col-sm-10">
                                        {{form.modalidad}}
                                        {{form.modalidad.errors}}
                                    </div>
                                </div>                                
                                 <div id="datos">
                                     
                                 </div>

                                <div class="form-group">
                                    <label for="grado" class="hidden-xs col-sm-2">Grado:</label>
                                    <div class="col-sm-10">
                                        {{form.grado}}
                                        {{form.grado.errors}}
                                    </div>
                                </div>      
                            </div>
 
                            <div class="col-xs-12 col-sm-6">                               
                                <div class="form-group">
                                    <label for="especialidad" class="hidden-xs col-sm-2">Especialidad:</label>
                                    <div class="col-sm-10">
                                        {{form.especialidad}}
                                        {{form.especialidad.errors}}
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="diagnostico" class="hidden-xs col-sm-2">Diagnostico:</label>
                                    <div class="col-sm-10">
                                        {{form.diagnostico}}
                                        {{form.diagnostico.errors}}
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="tema" class="hidden-xs col-sm-2">Tema:</label>
                                    <div class="col-sm-10">
                                        {{form.tema}}
                                        {{form.tema.errors}}
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="fechaatencion" class="hidden-xs col-sm-2">Fecha Atencion:</label>  
                                    <div class="col-sm-10" class='input-group date'>
                                        {{form.fechaatencion}} 
                                        {{form.fechaatencion.errors}}
                                        <span class="glyphicon glyphicon-calendar"></span>
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="horainicio" class="hidden-xs col-sm-2">Hora Inicio:</label>
                                    <div class="col-sm-10">
                                        {{form.horainicio}}
                                        {{form.horainicio.errors}}hh:mm:00
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="horafin" class="hidden-xs col-sm-2">Hora Fin:</label>
                                    <div class="col-sm-10">
                                        {{form.horafin}}
                                        {{form.horafin.errors}}hh:mm:00
                                    </div>
                                </div>  
                                <div class="form-group">
                                    <label for="observacion" class="hidden-xs col-sm-2">Observacion:</label>
                                    <div class="col-sm-10">
                                        {{form.observacion}}
                                        {{form.observacion.errors}}                                      
                                    </div>
                                </div>  
                            </div> <!-- class="col-xs-12 col-sm-6" -->                           
                        </div> <!--<div class="row"> -->
                        

                        <div class="panel-footer color-footer">
                            <button type="submit" class="btn btn-primary">
                                 Grabar
                            </button>
                        </div>
 

                    </div>
                </div>
            </form>



<!-- Modal -->
 
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" 
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <button type="button" class="close" 
                   data-dismiss="modal">
                       <span aria-hidden="true">&times;</span>
                       <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">
                   Alumno Nuevo
                </h4>
            </div>
            
            <!-- Modal Body -->
            <div class="modal-body">     

                <form  class="form-horizontal" role="form" method='POST'  > 
                {% csrf_token %}           
                  <div class="row"> 
                            <div class="col-xs-12 col-sm-6">
                                <div class="form-group">
                                    <label for="nombre" class="hidden-xs col-sm-2">Nombre:</label>
                                        <div class="col-sm-10">
                                            <input type="text" id="nombre" size="30" placeholder="Nombre de alumno"></input>
                                        </div>                                     
                                </div>  
                                <div class="form-group">
                                    <label for="sexo" class="hidden-xs col-sm-2">Sexo:</label>
                                    <div class="col-sm-10">
                                            <select name='sexo' id='sexo'>
                                            <option value="H">Hombre</option>
                                            <option value="M" selected>Mujer</option>
                                            </select>
                                    </div>
                                </div> 
                                                              
                                <div class="form-group">
                                    <label for="coloniaal" class="hidden-xs col-sm-2">Colonia: </label>
                                    <div class="col-sm-10">
                                       <input type="text" id="colonia" size="30"></input>
                                    </div>
                                </div>   
                                <div class="form-group">
                                    <label for="callenumal" class="hidden-xs col-sm-2">Calle:</label>
                                    <div class="col-sm-10">
                                         <input type="text" id="calle" size="20" placeholder="Calle y Numero"></input>
                                    </div>
                                </div>     
                                <div class="form-group">
                                    <label for="localidadal" class="hidden-xs col-sm-2">Localidad:</label>
                                    <div class="col-sm-10">
                                         <input type="text" id="localidad" size="20" placeholder="Localidad"></input>
                                    </div>
                                </div>                                                       
                            </div> <!-- class="col-xs-12 col-sm-6" --> 
 
                            <div class="col-xs-12 col-sm-6">                               
                                <div class="form-group">
                                    <label for="discapacidad" class="hidden-xs col-sm-2">Discapacidad:</label>
                                    <div class="col-sm-10">
                                        <select  name='discapacidad' id='discapacidad'>
                                            <option value="No">No</option>
                                            <option value="Motriz">Motriz</option>
                                            <option value="Visual">Visual</option>
                                            <option value="Auditiva">Auditiva</option>
                                            <option value="Intelectual">Intelectual</option>
                                            <option value="Otra" selected>Otra</option>
                                        </select>
                                    </div>
                                </div>   

                                <div class="form-group">
                                    <label for="escolaridad" class="hidden-xs col-sm-2">Escolaridad:</label>
                                    <div class="col-sm-10">
                                        <select name='escolaridad' id='escolaridad'>
                                            <option value="Preescolar">Preescolar</option>
                                            <option value="Primaria">Primaria</option>
                                            <option value="No Estudia y tiene edad escolar">No Estudia y tiene edad escolar</option>
                                            <option value="Bachillerato">Bachillerato</option>
                                            <option value="No Tiene Edad escolar">No Tiene Edad escolar</option>
                                            <option value="Cam">Cam</option>
                                            <option value="Cil" selected>Cil</option>
                                        </select>
                                    </div>
                                </div> 
                                <div class="form-group">
                                    <label for="escuela" class="hidden-xs col-sm-2">Escuela:</label>
                                    <div class="col-sm-10">
                                         <input type="text" id="escuela" size="20" placeholder="Escuela"></input>
                                    </div>
                                </div>                               
                            </div> <!-- class="col-xs-12 col-sm-6" -->        
                        </div> <!--<div class="row"> -->
                  </form>
            </div>
            
            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                        data-dismiss="modal">
                            Cerrar
                </button>
                <button id="alumno_modal" type="button" class="btn btn-primary">
                    Guardar
                </button>
            </div>
        </div>
    </div>
</div>

  


<link rel="stylesheet" href="http://code.jquery.com/ui/1.11.0/themes/smoothness/jquery-ui.css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js" type="text/javascript"></script>
<script src="http://code.jquery.com/ui/1.11.0/jquery-ui.js"></script>

<script>
         $( document ).ready( function() {
          $("#id_persona_display").autocomplete({
           source: '/auto',
           dataType: "jsonp",
           selectFirst: true,
           minLength: 4,
           select: function(event,ui) {
            $("#id_alumno").val(ui.item.id)
           }
          });
         });
 </script>



<script src="{% static 'js/vendor/jquery-datepicker-es.js' %}"></script>
<script>
  $(function(){ 
    $( "#id_fechaatencion" ).datepicker();   
  });
</script>
 
  
<script> 
        $('#alumno_modal').click(function(){
            
            $.ajax({ 
                type:'POST',
                url:'/addalu_modal/',                  
                data:{
                    nombre:$('#nombre').val(),
                    sexo:$('#sexo').val(),
                    colonia:$('#colonia').val(),
                    calle:$('#calle').val(),
                    localidad:$('#localidad').val(),
                    discapacidad:$('#discapacidad').val(),
                    escolaridad:$('#escolaridad').val(),
                    csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()

                },

                    success: function(data){                     
                    console.log('ok');
                    alert('Ok grabado correctamente');
                     
                    }
            });      
        }); 
</script>
  
<script>
        $('#id_hospital').on('change',Cambiar);
        function Cambiar(){
          var id =  $('#id_alumno').val()


          console.log(id);
          $.ajax({
                data : {'id' : id},
                url : '/edad_alumno/',
                type : 'get',
                success : function(data){
                        var object = JSON.parse(data);
                        var html = "<p>"+"Edad:" + object.edad +"</p><p>"+ "Meses:"+ object.mes + "</p>";
                        $('#datos').html(html);
                }
            });
        }
</script>


{% endblock content %}

 